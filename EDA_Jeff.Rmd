---
title: "EDA"
author: "Jeffrey Lin"
date: "2024-11-13"
output: html_document
---

# Load Libraries
```{r}
library(tidyverse)
library(readxl)

```


# Examine Merged Violence Dataframe
```{r}
head(merged_violence_df)

```

# Explore HDI Variable

##  Global

### Visualize Distribution
```{r}
merged_violence_df %>% 
  ggplot(aes(x = human_development_index)) +
  geom_density() +
  xlab("Human Development Index") + 
  ylab("Density") +
  ggtitle("Distribution of Global HDI Scores") +
  theme(plot.title = element_text(hjust = 0.5))

```

### Box Cox Transformation
```{r}
merged_violence_df <- merged_violence_df %>%
  mutate(
    human_development_index = human_development_index + 0.0001
  )

HDI <- merged_violence_df %>% 
  pull(human_development_index)

box_cox_MLE <- as.data.frame(MASS::boxcox(HDI ~ 1)) 

lambda <- box_cox_MLE %>%
  filter(y == max(y)) %>% 
  pull(x)

merged_violence_df <- merged_violence_df %>% 
  mutate(
    box_cox_HDI = (human_development_index ^ (lambda - 1)) / lambda  
  )

```

Distribution after Box Cox Transformation
```{r}

merged_violence_df %>% 
  ggplot(aes(x = box_cox_HDI)) +
  geom_density() +
  xlab("Box Cox Transformed Human Development Index") + 
  ylab("Density") +
  ggtitle("Distribution of Global HDI Scores") +
  theme(plot.title = element_text(hjust = 0.5))


```
### Scatter plot of HDI against average violence rate
```{r}
merged_violence_df %>% 
  ggplot(aes(x = human_development_index, avg_violence_rate)) +
  geom_point() +
  xlab("Human Development Index") +
  ylab("Average Violence Rate") +
  ggtitle("Average Rate of Violence by Human Development Index") +
  theme(plot.title = element_text(hjust = 0.5))
```


### Scatter plot of HDI against homicide rate
```{r}
merged_violence_df %>% 
  ggplot(aes(x = human_development_index, homicide_rate)) +
  geom_point() +
  xlab("Human Developmetn Index") +
  ylab("Homicide Rate") +
  ggtitle("Homicide Rate by Human Development Index") +
  theme(plot.title = element_text(hjust = 0.5))

```

## By Region

### Distribution of HDI by Region

```{r}
merged_violence_df %>% 
  ggplot(aes(x = human_development_index, color = region)) +
  geom_density() +
  facet_grid(.~region) +
  xlab("Human Development Index") + 
  ylab("Density") +
  ggtitle("Distribution of HDI Scores by Region") +
  theme(plot.title = element_text(hjust = 0.5))

```
### Distribution of HDI by Region with box cox transformation

```{r}
merged_violence_df %>% 
  ggplot(aes(x = box_cox_HDI, color = region)) +
  geom_density() +
  facet_grid(.~region) +
  xlab("Box Cox Transformed Human Development Index") + 
  ylab("Density") +
  ggtitle("Distribution of HDI Scores by Region") +
  theme(plot.title = element_text(hjust = 0.5))


```

### Scatter plot of HDI against average violence rate
```{r}
merged_violence_df %>% 
  ggplot(aes(x = human_development_index, avg_violence_rate, color = region)) +
  geom_point() +
  facet_grid(.~region) +
  xlab("Human Development Index") +
  ylab("Average Violence Rate") +
  ggtitle("Average Rate of Violence by Human Development Index") +
  theme(plot.title = element_text(hjust = 0.5))
```
### Scatter plot of HDI against homicide rate
```{r}
merged_violence_df %>% 
  ggplot(aes(x = human_development_index, homicide_rate, color = region)) +
  geom_point() +
  facet_grid(.~region) +
  xlab("Human Development Index") +
  ylab("Homicide Rate") +
  ggtitle("Homicide Rate by Human Development Index") +
  theme(plot.title = element_text(hjust = 0.5))

```

## By Development Status

### Add Development Variable

```{r}
merged_violence_df <- merged_violence_df %>% 
  mutate(development_status = factor(case_when(
    human_development_index < 0.550 ~ "low",
    human_development_index >= 0.550 & human_development_index < 0.700 ~ "medium",
    human_development_index >= 0.700 & human_development_index < 0.800 ~ "high",
    human_development_index >= 0.800 ~ "very high"
    ))
  )
```

### Distribution of Development Status
```{r}
merged_violence_df %>% 
  drop_na(development_status) %>% 
  ggplot(aes(x = development_status, fill = development_status)) +
  geom_bar() +
  xlab("Development Status") + 
  ggtitle("Distribution of Development Status") + 
  theme(plot.title = element_text(hjust = 0.5))

```

