---
title: "EDA"
author: "Jeffrey Lin"
date: "2024-11-13"
output: html_document
---

# Load Libraries
```{r}
library(tidyverse)
library(readxl)
library(rlang)

```


# Data Pre-Processing 

## Examine Merged Violence Dataframe
```{r}
head(merged_violence_df)

```


## Create Separate Dataframe for Variables of Interest

```{r}

EDA_var_interest <- merged_violence_df %>% 
  select(c(country:avg_violence_rate), human_development_index, 
         inflation_rate, avg_personnel_rate, total_arms_seized) %>% 
  mutate(development_status = factor(case_when(
    human_development_index < 0.550 ~ "low",
    human_development_index >= 0.550 & human_development_index < 0.700 ~ "medium",
    human_development_index >= 0.700 & human_development_index < 0.800 ~ "high",
    human_development_index >= 0.800 ~ "very high"
    ))
  )  

head(EDA_var_interest)  

```

## Generalized Plotting Function
```{r}
make_plot = function(data, geom_type, title, grouping = "None", ...) {
  plt <- data %>% 
    ggplot(aes(...)) +
    geom_type() + 
    ggtitle(title) +
    theme(plot.title = element_text(hjust = 0.5))
  
  if (grouping != "None") {
    plt + facet_grid(.~grouping)
  }
  
  return(plt)
  
}


make_plot(EDA_var_interest, geom_point, title = "Average Violence Rate by HDI", 
          x = human_development_index, y =avg_violence_rate)

```



# Scatter Plots

## Outcome Variable: Homicide Rate
```{r}
var_interest <- EDA_var_interest %>% 
  select(c(human_development_index:total_arms_seized)) %>% 
  colnames()


map(var_interest, \(x) make_plot(EDA_var_interest, geom_point, 
    str_c("Homicide Rate by ", x), x = .data[[x]], y = homicide_rate
    ))

```


## Outcome Variable: Average Violence Rate
```{r}

```
















# Explore HDI Variable

##  Global

### Visualize Distribution
```{r}
merged_violence_df %>% 
  ggplot(aes(x = human_development_index)) +
  geom_density() +
  xlab("Human Development Index") + 
  ylab("Density") +
  ggtitle("Distribution of Global HDI Scores") +
  theme(plot.title = element_text(hjust = 0.5))

```

### Box Cox Transformation
```{r}
merged_violence_df <- merged_violence_df %>%
  mutate(
    human_development_index = human_development_index + 0.0001
  )

HDI <- merged_violence_df %>% 
  pull(human_development_index)

box_cox_MLE <- as.data.frame(MASS::boxcox(HDI ~ 1)) 

lambda <- box_cox_MLE %>%
  filter(y == max(y)) %>% 
  pull(x)

merged_violence_df <- merged_violence_df %>% 
  mutate(
    box_cox_HDI = (human_development_index ^ (lambda - 1)) / lambda  
  )

```

Distribution after Box Cox Transformation
```{r}

merged_violence_df %>% 
  ggplot(aes(x = box_cox_HDI)) +
  geom_density() +
  xlab("Box Cox Transformed Human Development Index") + 
  ylab("Density") +
  ggtitle("Distribution of Global HDI Scores") +
  theme(plot.title = element_text(hjust = 0.5))


```
### Scatter plot of HDI against average violence rate
```{r}
merged_violence_df %>% 
  ggplot(aes(x = human_development_index, avg_violence_rate)) +
  geom_point() +
  xlab("Human Development Index") +
  ylab("Average Violence Rate") +
  ggtitle("Average Rate of Violence by Human Development Index") +
  theme(plot.title = element_text(hjust = 0.5))
```


### Scatter plot of HDI against homicide rate
```{r}
merged_violence_df %>% 
  ggplot(aes(x = human_development_index, homicide_rate)) +
  geom_point() +
  xlab("Human Development Index") +
  ylab("Homicide Rate") +
  ggtitle("Homicide Rate by Human Development Index") +
  theme(plot.title = element_text(hjust = 0.5))

```

## By Region

### Distribution of HDI by Region

```{r}
merged_violence_df %>% 
  ggplot(aes(x = human_development_index, color = region)) +
  geom_density() +
  facet_grid(.~region) +
  xlab("Human Development Index") + 
  ylab("Density") +
  ggtitle("Distribution of HDI Scores by Region") +
  theme(plot.title = element_text(hjust = 0.5))

```
### Distribution of HDI by Region with box cox transformation

```{r}
merged_violence_df %>% 
  ggplot(aes(x = box_cox_HDI, color = region)) +
  geom_density() +
  facet_grid(.~region) +
  xlab("Box Cox Transformed Human Development Index") + 
  ylab("Density") +
  ggtitle("Distribution of HDI Scores by Region") +
  theme(plot.title = element_text(hjust = 0.5))


```

### Scatter plot of HDI against average violence rate
```{r}
merged_violence_df %>% 
  ggplot(aes(x = human_development_index, avg_violence_rate, color = region)) +
  geom_point() +
  facet_grid(.~region) +
  xlab("Human Development Index") +
  ylab("Average Violence Rate") +
  ggtitle("Average Rate of Violence by Human Development Index") +
  theme(plot.title = element_text(hjust = 0.5))
```
### Scatter plot of HDI against homicide rate
```{r}
merged_violence_df %>% 
  ggplot(aes(x = human_development_index, homicide_rate, color = region)) +
  geom_point() +
  facet_grid(.~region) +
  xlab("Human Development Index") +
  ylab("Homicide Rate") +
  ggtitle("Homicide Rate by Human Development Index") +
  theme(plot.title = element_text(hjust = 0.5))

```

## By Development Status

### Add Development Variable

```{r}
merged_violence_df <- merged_violence_df %>% 
  mutate(development_status = factor(case_when(
    human_development_index < 0.550 ~ "low",
    human_development_index >= 0.550 & human_development_index < 0.700 ~ "medium",
    human_development_index >= 0.700 & human_development_index < 0.800 ~ "high",
    human_development_index >= 0.800 ~ "very high"
    ))
  )
```

### Distribution of Development Status
```{r}
merged_violence_df %>% 
  drop_na(development_status) %>% 
  ggplot(aes(x = development_status, fill = development_status)) +
  geom_bar() +
  xlab("Development Status") + 
  ggtitle("Distribution of Development Status") + 
  theme(plot.title = element_text(hjust = 0.5))

```
# Scrap Code
```{r}


```


